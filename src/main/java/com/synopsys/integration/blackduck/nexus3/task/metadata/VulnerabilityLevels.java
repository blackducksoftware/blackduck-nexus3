package com.synopsys.integration.blackduck.nexus3.task.metadata;

import java.util.HashMap;
import java.util.Map;

public class VulnerabilityLevels {
    public static final String HIGH_VULNERABILITY = "HIGH";
    public static final String MEDIUM_VULNERABILITY = "MEDIUM";
    public static final String LOW_VULNERABILITY = "LOW";

    private final Map<String, Integer> trackedVulnerabilities;

    public VulnerabilityLevels() {
        trackedVulnerabilities = new HashMap<>();
    }

    public void addVulnerability(final String vulnerability) {
        addXVulnerabilities(vulnerability, 1);
    }

    public void addXVulnerabilities(final String vulnerability, final int count) {
        final int vulnerabilityCount = getVulnerabilityCount(vulnerability, 0);
        trackedVulnerabilities.put(vulnerability, vulnerabilityCount + count);
    }

    public int getVulnerabilityCount(final String vulnerability, final int defaultValue) {
        final Integer count = trackedVulnerabilities.get(vulnerability);
        if (count == null) {
            return defaultValue;
        }
        return count;
    }

    public int getHighVulnerabilityCount() {
        return getVulnerabilityCount(HIGH_VULNERABILITY, 0);
    }

    public int getMediumVulnerabilityCount() {
        return getVulnerabilityCount(MEDIUM_VULNERABILITY, 0);
    }

    public int getLowVulnerabilityCount() {
        return getVulnerabilityCount(LOW_VULNERABILITY, 0);
    }
}
