package com.synopsys.integration.blackduck.nexus3.task.metadata;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.synopsys.integration.blackduck.api.generated.view.VulnerabilityV2View;

public class VulnerabilityLevels {
    public static final String HIGH_VULNERABILITY = "HIGH";
    public static final String MEDIUM_VULNERABILITY = "MEDIUM";
    public static final String LOW_VULNERABILITY = "LOW";

    private final Map<String, Integer> trackedVulnerabilities;

    public VulnerabilityLevels() {
        trackedVulnerabilities = new HashMap<>();
    }

    public void addVulnerabilityCounts(final List<VulnerabilityV2View> vulnerabilityViews) {
        for (final VulnerabilityV2View vulnerability : vulnerabilityViews) {
            final String severity = vulnerability.severity.toUpperCase();
            addVulnerability(severity);
        }
    }

    public void addHighVulnerability() {
        addVulnerability(HIGH_VULNERABILITY);
    }

    public void addMediumVulnerability() {
        addVulnerability(MEDIUM_VULNERABILITY);
    }

    public void addLowVulnerability() {
        addVulnerability(LOW_VULNERABILITY);
    }

    public void addVulnerability(final String vulnerability) {
        addXVulnerabilities(vulnerability, 1);
    }

    public void addXVulnerabilities(final String vulnerability, final int count) {
        final Integer vulnerabilityCount = trackedVulnerabilities.get(vulnerability);
        if (vulnerabilityCount == null) {
            trackedVulnerabilities.put(vulnerability, 0 + count);
        } else {
            trackedVulnerabilities.put(vulnerability, vulnerabilityCount + count);
        }
    }

    public int getHighVulnerabilityCount() {
        return trackedVulnerabilities.get(HIGH_VULNERABILITY);
    }

    public int getMediumVulnerabilityCount() {
        return trackedVulnerabilities.get(MEDIUM_VULNERABILITY);
    }

    public int getLowVulnerabilityCount() {
        return trackedVulnerabilities.get(LOW_VULNERABILITY);
    }
}
